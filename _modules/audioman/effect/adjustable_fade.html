<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>audioman.effect.adjustable_fade &#8212; audioman 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script src="../../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for audioman.effect.adjustable_fade</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">.effect</span> <span class="kn">import</span> <span class="n">Effect</span>

<div class="viewcode-block" id="AdjustableFade">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade">[docs]</a>
<span class="k">class</span> <span class="nc">AdjustableFade</span><span class="p">(</span><span class="n">Effect</span><span class="p">):</span>
    <span class="n">OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;gain0&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;gain1&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;curve_ratio&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<div class="viewcode-block" id="AdjustableFade.__init__">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Audio effect. This effect will last the specified length in samples. If the duration is specified (in seconds), then it will use that length. This will assume the sample rate is `4400`, unless specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            length (int, optional): Length of effect in samples. Defaults to None.</span>
<span class="sd">            duration (float, optional): Duration of effect in seconds. Defaults to None.</span>
<span class="sd">            sample_rate (int, optional): Audio Sample rate. Defaults to 4400. This may be used by some effects.</span>
<span class="sd">            **options (dict[str, Any]): Effect options.</span>
<span class="sd">        </span>
<span class="sd">        Options:</span>
<span class="sd">            gain0 (float): Start gain. Value between 0 and 1. Defaults to 1.</span>
<span class="sd">            gain1 (float): End gain. Value between 0 and 1. Defaults to 0.</span>
<span class="sd">            curve_ratio (float): Curve adjust ratio. Value between -1 and 1. Defaults to 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">length</span><span class="p">,</span>
            <span class="n">duration</span><span class="p">,</span>
            <span class="n">sample_rate</span><span class="p">,</span>
            <span class="n">options</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="AdjustableFade.get">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.get">[docs]</a>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_fade</span><span class="p">(</span>
            <span class="n">gain0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;gain0&#39;</span><span class="p">],</span>
            <span class="n">gain1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;gain1&#39;</span><span class="p">],</span>
            <span class="n">curve_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;curve_ratio&#39;</span><span class="p">],</span>
            <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="AdjustableFade.linear_fade">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.linear_fade">[docs]</a>
    <span class="k">def</span> <span class="nf">linear_fade</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">curve_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate fade scaler for the specified length.</span>

<span class="sd">        Args:</span>
<span class="sd">            gain0 (float): Start gain</span>
<span class="sd">            gain1 (float): End gain</span>
<span class="sd">            curve_ratio (float): Mid-fade adjust (%) between 0 and 1</span>
<span class="sd">            length (int): Sample length of the fade (not sample rate).</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray[float]: numpy array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">gain0</span> <span class="o">==</span> <span class="n">gain1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gain0</span><span class="p">]</span> <span class="o">*</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">((</span><span class="n">curve_ratio</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">curve_ratio</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">)):</span>
            <span class="n">_curve_ratio</span> <span class="o">=</span> <span class="n">curve_ratio</span> <span class="o">*</span> <span class="mi">2</span>
            <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_curve_ratio</span><span class="p">))</span> <span class="o">+</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span> <span class="o">*</span> <span class="n">_curve_ratio</span><span class="p">))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">curve_ratio</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">-</span> <span class="n">curve_ratio</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">simple_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">curve_ratio</span><span class="p">)),</span> <span class="n">length</span><span class="p">)</span></div>


<div class="viewcode-block" id="AdjustableFade.simple_curve">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.simple_curve">[docs]</a>
    <span class="k">def</span> <span class="nf">simple_curve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">power</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve_adjust</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="AdjustableFade.scale_curve">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.scale_curve">[docs]</a>
    <span class="k">def</span> <span class="nf">scale_curve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">env</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gain0</span> <span class="o">-</span> <span class="n">gain1</span><span class="p">)</span> <span class="o">*</span> <span class="n">env</span><span class="p">)</span></div>


<div class="viewcode-block" id="AdjustableFade.linear">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.linear">[docs]</a>
    <span class="k">def</span> <span class="nf">linear</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></div>

            

<div class="viewcode-block" id="AdjustableFade.cosine_curve">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.cosine_curve">[docs]</a>
    <span class="k">def</span> <span class="nf">cosine_curve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates half a cosine wave of the specified length</span>

<span class="sd">        Args:</span>
<span class="sd">            gain0 (float): gain0</span>
<span class="sd">            gain1 (float): gain1</span>
<span class="sd">            length (int): length</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray: numpy array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">gain0</span> <span class="o">&gt;</span> <span class="n">gain1</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">/</span> <span class="n">length</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="p">))</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span></div>


<div class="viewcode-block" id="AdjustableFade.cos_curve">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.cos_curve">[docs]</a>
    <span class="k">def</span> <span class="nf">cos_curve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">power</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve_adjust</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span></div>


<div class="viewcode-block" id="AdjustableFade.curve_adjust">
<a class="viewcode-back" href="../../../audioman.effect.html#audioman.effect.adjustable_fade.AdjustableFade.curve_adjust">[docs]</a>
    <span class="k">def</span> <span class="nf">curve_adjust</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gain0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">gain1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">power</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">env</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_curve</span><span class="p">(</span><span class="n">gain0</span><span class="p">,</span> <span class="n">gain1</span><span class="p">,</span>
            <span class="p">(</span><span class="n">env</span> <span class="k">if</span> <span class="p">(</span><span class="n">power</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">power</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">env</span><span class="p">))))</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>
</div>


</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">audioman</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, ego-lay-atman-bay.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>